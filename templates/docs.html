{% extends "base.html" %}

{% block title %}
Docs - DevOps Notes Manager
{% endblock %}

{% block content %}

<div class="max-w-5xl mx-auto pb-12">
  <div class="mb-10 text-center">
    <h1 class="text-4xl font-bold text-zinc-900 dark:text-white mb-2"> Documentation</h1>
    <p class="text-lg text-zinc-500 dark:text-zinc-400">How this application works and how to run it.</p>
  </div>

  <div class="grid grid-cols-1 gap-6">
    
    <div class="bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 shadow-sm">
      <h3 class="text-xl font-bold text-zinc-900 dark:text-white mb-4 flex items-center gap-2"> Local Setup</h3>
      <div class="prose prose-sm dark:prose-invert max-w-none text-zinc-600 dark:text-zinc-400">
        <p><strong class="text-zinc-900 dark:text-white">Prerequisites:</strong></p>
        <ul class="list-disc pl-5 space-y-1 mb-4">
          <li>Python 3.8+</li>
          <li>MySQL 8.0+ (or use Docker for MySQL)</li>
          <li>pip (Python package manager)</li>
        </ul>
        
        <p><strong class="text-zinc-900 dark:text-white">Steps:</strong></p>
        <ol class="list-decimal pl-5 space-y-2">
          <li>Clone the repository</li>
          <li>Create a virtual environment: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">python -m venv venv</code></li>
          <li>Activate the virtual environment:
            <ul class="list-disc pl-5 mt-1 space-y-1">
              <li>Windows: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">venv\Scripts\activate</code></li>
              <li>Linux/Mac: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">source venv/bin/activate</code></li>
            </ul>
          </li>
          <li>Install dependencies: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">pip install -r requirements.txt</code></li>
          <li>Create a <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">.env</code> file with database credentials</li>
          <li>Set up the MySQL database and create the notes table</li>
          <li>Run the Flask app: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">python app.py</code></li>
          <li>Access the application at <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">http://localhost:5000</code></li>
        </ol>
      </div>
    </div>

    <div class="bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 shadow-sm">
      <h3 class="text-xl font-bold text-zinc-900 dark:text-white mb-4 flex items-center gap-2"> Docker Setup</h3>
      <div class="prose prose-sm dark:prose-invert max-w-none text-zinc-600 dark:text-zinc-400">
        <p><strong class="text-zinc-900 dark:text-white">Prerequisites:</strong></p>
        <ul class="list-disc pl-5 space-y-1 mb-4">
          <li>Docker Desktop installed</li>
          <li>Docker Compose (included with Docker Desktop)</li>
        </ul>
        
        <p><strong class="text-zinc-900 dark:text-white">Quick Start:</strong></p>
        <ol class="list-decimal pl-5 space-y-4">
          <li>Create a <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">.env</code> file in the project root with:
            <pre class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2"><code>DB_HOST=mysql
DB_USER=root
DB_PASSWORD=rootpassword
DB_NAME=devops_notes
MYSQL_ROOT_PASSWORD=rootpassword</code></pre>
          </li>
          <li>Build and start containers:
            <pre class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2"><code>docker compose up --build</code></pre>
          </li>
          <li>Initialize the database (one-time setup):
            <div class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2 space-y-2">
                <p><code>docker exec -it devops-mysql mysql -uroot -prootpassword devops_notes</code></p>
                <p class="text-zinc-500 italic"># Then run SQL:</p>
                <div class="pl-2 border-l-2 border-zinc-300 dark:border-zinc-600">
CREATE TABLE notes (
  id INT AUTO_INCREMENT PRIMARY KEY,
  command VARCHAR(255) NOT NULL,
  description TEXT NOT NULL,
  category VARCHAR(50),
  tags VARCHAR(255),
  example TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
                </div>
            </div>
          </li>
          <li>Access the application at <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">http://localhost:5000</code></li>
        </ol>
        
        <p class="mt-6"><strong class="text-zinc-900 dark:text-white">Useful Commands:</strong></p>
        <ul class="list-disc pl-5 space-y-1">
          <li>Stop containers: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">docker compose down</code></li>
          <li>Stop and remove volumes: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">docker compose down -v</code></li>
          <li>View logs: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">docker compose logs -f</code></li>
          <li>Rebuild after changes: <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">docker compose up --build</code></li>
        </ul>
      </div>
    </div>

    <div class="bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 shadow-sm">
      <h3 class="text-xl font-bold text-zinc-900 dark:text-white mb-4 flex items-center gap-2"> DevOps Concepts Practiced</h3>
      <div class="prose prose-sm dark:prose-invert max-w-none text-zinc-600 dark:text-zinc-400">
        <p><strong class="text-zinc-900 dark:text-white">This project demonstrates:</strong></p>
        <ul class="list-disc pl-5 space-y-1">
          <li><strong>Containerization:</strong> Application and database run in isolated Docker containers</li>
          <li><strong>Service Orchestration:</strong> Docker Compose manages multi-container setup</li>
          <li><strong>Environment Variables:</strong> Secure configuration using <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">.env</code> files</li>
          <li><strong>Persistent Storage:</strong> Docker volumes for database data persistence</li>
          <li><strong>Service Discovery:</strong> Containers communicate via Docker network</li>
        </ul>
      </div>
    </div>

    <div class="bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 shadow-sm">
      <h3 class="text-xl font-bold text-zinc-900 dark:text-white mb-4 flex items-center gap-2"> Database Schema</h3>
      <div class="prose prose-sm dark:prose-invert max-w-none text-zinc-600 dark:text-zinc-400">
        <p>The application uses a MySQL database with the following table structure:</p>
        <pre class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2"><code>CREATE TABLE notes (
  id INT AUTO_INCREMENT PRIMARY KEY,
  command VARCHAR(255) NOT NULL,
  description TEXT NOT NULL,
  category VARCHAR(50),
  tags VARCHAR(255),
  example TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);</code></pre>
        <p class="mt-4"><strong class="text-zinc-900 dark:text-white">Fields:</strong></p>
        <ul class="list-disc pl-5 space-y-1">
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">id</code>: Primary key, auto-incrementing</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">command</code>: The DevOps command or operation name</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">description</code>: Detailed explanation (HTML formatted)</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">category</code>: Predefined category for organization</li>
        </ul>
      </div>
    </div>

    <div class="bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800 p-6 shadow-sm">
      <h3 class="text-xl font-bold text-zinc-900 dark:text-white mb-4 flex items-center gap-2"> REST API Usage</h3>
      <div class="prose prose-sm dark:prose-invert max-w-none text-zinc-600 dark:text-zinc-400">
        <p>The application now supplies a REST API for programmatic access to your notes.</p>
        
        <p class="mt-4"><strong class="text-zinc-900 dark:text-white">Authentication:</strong></p>
        <p>All API requests require an <code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">X-API-Token</code> header. You can generate your token in the <a href="{{ url_for('auth.settings') }}" class="text-accent-600 hover:underline">Settings</a> page.</p>
        <pre class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2"><code>curl -H "X-API-Token: YOUR_TOKEN" http://localhost/api/notes</code></pre>
        
        <p class="mt-4"><strong class="text-zinc-900 dark:text-white">Endpoints:</strong></p>
        <ul class="list-disc pl-5 space-y-1">
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">GET /api/notes</code> - List all notes (supports -category=X&search=Y)</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">GET /api/notes/&lt;id&gt;</code> - Get a single note</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">POST /api/notes</code> - Create a new note (JSON body required)</li>
          <li><code class="bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-xs font-mono text-zinc-800 dark:text-zinc-200">GET /api/categories</code> - List all available categories</li>
        </ul>
        
        <p class="mt-4"><strong class="text-zinc-900 dark:text-white">Example Creation:</strong></p>
<pre class="bg-zinc-100 dark:bg-zinc-800 p-3 rounded-lg text-xs font-mono text-zinc-800 dark:text-zinc-200 overflow-x-auto mt-2"><code>curl -X POST http://localhost/api/notes \
  -H "X-API-Token: YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"command": "ls -la", "description": "List all files", "category": "Linux"}'</code></pre>
      </div>
    </div>

  </div>
</div>

{% endblock %}
